<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Gallery</title>
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="/styles.css?v=2" />
</head>
<body>
  <header>
    <h3>HAN's</h3>
    <button id="mobileMenuBtn" class="header-btn mobile-menu-toggle" aria-label="Menu" title="Menu"><i class="fa-solid fa-bars"></i></button>
    <div class="header-actions">
      <button class="mobile-close-btn" onclick="closeMobileMenu()" title="Close">✕</button>
      <!-- Desktop-only Search -->
      <div class="search-wrapper desktop-only">
        <input type="text" id="searchInputDesktop" class="search-input" placeholder="Search titles..." />
        <button id="searchClearBtnDesktop" class="search-clear" type="button" title="Clear">✕</button>
      </div>
      <!-- Mobile-only Search -->
      <div class="search-wrapper mobile-only">
        <input type="text" id="searchInputMobile" class="search-input" placeholder="Search titles..." />
        <button id="searchClearBtnMobile" class="search-clear" type="button" title="Clear">✕</button>
      </div>
      <span id="userDisplay" class="header-user" style="display:none;"></span>
   
      <!-- Meta Info -->
      <button id="toggleMetaBtn" class="header-btn" title="Show/Hide Info">
        <i class="fa-solid fa-circle-info"></i><span class="btn-label"> Info</span>
      </button>
      <!-- Add Album -->
      <button id="createAlbumBtn" class="header-btn create-album-btn" style="display:none;" title="New Album">
        <i class="fa-solid fa-folder-plus"></i><span class="btn-label"> New Album</span>      
      <!-- Toggle Image Upload -->
      <button id="toggleUploadBtn" class="header-btn" title="Hide Upload">
        <i class="fa-regular fa-square-plus"></i><span class="btn-label"> Upload</span>
      </button>
      <!-- Dark Mode Toggle -->
      <button id="darkModeToggle" class="header-btn" type="button" title="Toggle Dark/Light Mode">
        <i id="darkModeIcon" class="fa-solid fa-moon"></i><span class="btn-label"> Dark Mode</span>
      </button>
      <!-- Login/Logout -->
      <button id="loginBtn" class="header-btn" title="Login">
        <i class="fa-solid fa-right-to-bracket"></i><span class="btn-label"> Login</span>
      </button>
      <button id="logoutBtn" class="header-btn" style="display:none;" title="Logout">
        <i class="fa-solid fa-right-from-bracket"></i><span class="btn-label"> Logout</span>
      </button>
    </div>
  </header>

  <!-- Mobile Menu Overlay -->
  <div id="mobileMenuOverlay" class="mobile-menu-overlay"></div>

  <!-- Admin Dashboard -->
  <section id="adminDashboard" class="admin-dashboard" style="display:none;">
    <h2>Dashboard</h2>
    <button class="close-dashboard-btn" onclick="closeDashboard()">✕ Close</button>
    
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-value" id="statUsers">-</div>
        <div class="stat-label">Users</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" id="statImages">-</div>
        <div class="stat-label">Images</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" id="statAlbums">-</div>
        <div class="stat-label">Albums</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" id="statLikes">-</div>
        <div class="stat-label">Likes</div>
      </div>
    </div>

    <div class="dashboard-section">
      <h3>Recent Images</h3>
      <div id="recentImagesList"></div>
    </div>

    <div class="dashboard-section">
      <h3>Pending Approvals</h3>
      <div id="pendingUsersList"></div>
    </div>

    <div class="dashboard-section">
      <h3>Users</h3>
      <div id="usersList"></div>
    </div>

    <div class="dashboard-section">
      <h3>Comments</h3>
      <div id="commentsManagement"></div>
    </div>

    <div class="dashboard-section">
      <h3>Albums</h3>
      <div id="albumsManagement"></div>
    </div>
  </section>

  <section class="albums-bar">
    <div class="albums-scroll" id="albumsList"></div>
  
  </section>

  <!-- Sort Section -->
  <section class="sort-section">
    <div class="sort-bar">
      
      <div class="size-controls" aria-label="Card size">
        <button type="button" class="size-btn" data-size="small" title="Small">S</button>
        <button type="button" class="size-btn" data-size="medium" title="Medium">M</button>
        <button type="button" class="size-btn" data-size="large" title="Large">L</button>
      </div>

      <div class="sort-controls">
        <!-- <label for="sortSelect"><i class="fa-solid fa-sort"></i></label> -->
        <select id="sortSelect">
          <option value="created_desc">Newest</option>
          <option value="created_asc">Oldest</option>
          <option value="taken_desc">Date Taken (DEC)</option>
          <option value="taken_asc">Date Taken (ASC)</option>
          <option value="title_asc">Title (A–Z)</option>
          <option value="title_desc">Title (Z–A)</option>
          <option value="likes_desc">Most Liked</option>
          <option value="likes_asc">Least Liked</option>
        </select>
      </div>

    </div>
  </section>

  <!-- Gallery -->
  <section class="gallery" id="gallery">
  </section>

  <div id="modal" class="modal">
    <span class="modal-close">&times;</span>
    <button class="modal-nav modal-prev" onclick="prevImage()" title="Previous">&lsaquo;</button>
    <img class="modal-content" id="modalImg" />
    <button class="modal-nav modal-next" onclick="nextImage()" title="Next">&rsaquo;</button>
    <div id="modalCaption"></div>
    <button id="toggleCommentsBtn" class="toggle-comments-btn" title="Show Comments"><i class="fa-solid fa-comments"></i></button>
    <div id="commentsOverlay" class="comments-overlay">
      <div class="comments-container">
        <div class="comments-header">
          <h3>Comments</h3>
          <button class="close-comments-btn" onclick="toggleCommentsPanel()" title="Close">✕</button>
        </div>
        <div id="commentsList" class="comments-list"></div>
        <form id="commentForm" class="comment-form">
          <input type="text" id="commentAuthor" placeholder="Your name (optional)" maxlength="100" />
          <textarea id="commentText" placeholder="Add a comment..." required maxlength="500" rows="2"></textarea>
          <button type="submit">Post</button>
        </form>
      </div>
    </div>
  </div>

  <!-- Login Modal -->
  <div id="loginModal" class="modal">
    <div class="modal-box">
      <h2>Login</h2>
      <form id="loginForm">
        <input type="text" id="username" placeholder="Email" required />
        <input type="password" id="password" placeholder="Password" required />
        <button type="submit">Login</button>
        <button type="button" class="cancel-btn" onclick="closeLoginModal()">Cancel</button>
      </form>
      <div id="loginError"></div>
      <div style="margin-top:8px; font-size: 14px;">
        <a href="#" onclick="openSignupModal(); return false;" style="color: white; text-decoration: none;">Create an account</a>
      </div>
    </div>
  </div>

  <!-- Signup Modal -->
  <div id="signupModal" class="modal">
    <div class="modal-box">
      <h2>Sign Up</h2>
      <form id="signupForm">
        <input type="email" id="signupEmail" placeholder="Email" required />
        <input type="password" id="signupPassword" placeholder="Password (min 8 chars)" minlength="8" required />
        <input type="password" id="signupPassword2" placeholder="Confirm password" minlength="8" required />
        <button type="submit">Create Account</button>
        <button type="button" class="cancel-btn" onclick="closeSignupModal()">Cancel</button>
      </form>
      <div id="signupError"></div>
    </div>
  </div>

  <!-- Create Album Modal -->
  <div id="createAlbumModal" class="modal">
    <div class="modal-box">
      <h2>Create Album</h2>
      <form id="createAlbumForm">
        <input type="text" id="albumName" placeholder="Album name" required />
         <label class="checkbox-row">
           <input type="checkbox" id="albumPublic" checked />
           Public Album
         </label>
        <button type="submit">Create</button>
        <button type="button" class="cancel-btn" onclick="closeCreateAlbumModal()">Cancel</button>
      </form>
      <div id="albumError"></div>
    </div>
  </div>

  <!-- User Dashboard Modal -->
  <div id="userDashboardModal" class="modal">
    <div class="modal-box">
      <h2>My Account</h2>
      <div class="user-stats">
        <div class="stat-row">
          <span class="stat-label">Email:</span>
          <span id="userEmail" class="stat-value">-</span>
        </div>
        <div class="stat-row">
          <span class="stat-label">Images Uploaded:</span>
          <span id="userImageCount" class="stat-value">-</span>
        </div>
        <div class="stat-row">
          <span class="stat-label">Total Likes Received:</span>
          <span id="userLikesCount" class="stat-value">-</span>
        </div>
        <div class="stat-row">
          <span class="stat-label">Comments Posted:</span>
          <span id="userCommentsCount" class="stat-value">-</span>
        </div>
      </div>
      <div class="user-actions">
        <button type="button" class="delete-account-btn" onclick="deleteMyAccount()">Delete My Account</button>
        <button type="button" class="cancel-btn" onclick="closeUserDashboard()">Close</button>
      </div>
    </div>
  </div>

  <!-- Upload Modal -->
  <div id="uploadModal" class="modal">
    <div class="modal-box">
      <h2>Upload Image</h2>
      <form id="uploadForm">
        <select id="albumSelect" name="album_id">
          <option value="">No Album</option>
        </select>
        <input type="text" name="title" placeholder="Title" />
        <textarea name="description" placeholder="Description (optional)" rows="3" style="margin: 8px 0; padding: 8px; background: var(--bg-secondary); color: var(--text-primary); border: 1px solid var(--border-color); border-radius: 4px;"></textarea>
        <input type="date" name="date_taken" placeholder="Date taken (optional)" />
        <input type="file" name="image" accept="image/*" required />
        <button type="submit">Upload</button>
        <button type="button" class="cancel-btn" onclick="closeUploadModal()">Cancel</button>
      </form>
      <div id="uploadStatus"></div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <p>&copy; 2025 <a href="mailto:iyfhan@gmail.com" style="text-decoration: none; color: #888;">Han</a>'s Gallery. All rights reserved.</p>
  </footer>

  <script src="/app.js"></script>
</body>
</html>
